function updateGateSelectionPage()
    local elements = {
        {text = string.rep("-", 49), y = 3}
    }
    if #stargates == 0 then
        table.insert(elements, {text = "No gates detected.", y = 5})
    else
        for i = 1, maxVisibleLines do
            local gateIndex = scrollPos + i - 1
            if gateIndex <= #stargates and gateIndex > 0 then
                local name = stargates[gateIndex]
                local displayName = config.gateNames[name] or name
                local addr = modem.callRemote(name, "localAddress") or "Unknown"
                local state = modem.callRemote(name, "stargateState") or "Disconnected"
                local group = config.gateGroups[name] or "None"
                local line = (gateIndex == selectedIndex and "> " or "  ") .. displayName .. " [" .. group .. "]: " .. addr .. " (" .. state .. ")"
                table.insert(elements, {text = line, y = 4 + i, bgColor = gateIndex == selectedIndex and config.UI_COLORS.buttons})
            end
        end
    end
    table.insert(elements, {text = string.rep("-", 49), y = 17})
    table.insert(elements, {text = "[S]elect  [F1] Back", y = 18, centered = true})
    drawPage("Gate Selection", elements)
end

function updateNameGatePage()
    drawPage("Name Gate", {
        {text = string.rep("-", 49), y = 3},
        {text = "Current: " .. (config.gateNames[gateName] or gateName or "None"), y = 5, centered = true},
        {text = "Type new name, then Enter", y = 7, centered = true},
        {text = "New Name: " .. dialingAddress, y = 9, centered = true},
        {text = string.rep("-", 49), y = 17},
        {text = "[F1] Back", y = 18, centered = true}
    })
end